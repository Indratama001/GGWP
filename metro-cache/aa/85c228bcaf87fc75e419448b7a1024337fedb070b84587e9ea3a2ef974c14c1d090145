{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/objectSpread","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = getChildEventSubscriber;\n\n  var _objectSpread2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/objectSpread\"));\n\n  function getChildEventSubscriber(addListener, key) {\n    var actionSubscribers = new Set();\n    var willFocusSubscribers = new Set();\n    var didFocusSubscribers = new Set();\n    var willBlurSubscribers = new Set();\n    var didBlurSubscribers = new Set();\n\n    var getChildSubscribers = function getChildSubscribers(evtName) {\n      switch (evtName) {\n        case 'action':\n          return actionSubscribers;\n\n        case 'willFocus':\n          return willFocusSubscribers;\n\n        case 'didFocus':\n          return didFocusSubscribers;\n\n        case 'willBlur':\n          return willBlurSubscribers;\n\n        case 'didBlur':\n          return didBlurSubscribers;\n\n        default:\n          return null;\n      }\n    };\n\n    var emit = function emit(type, payload) {\n      var payloadWithType = (0, _objectSpread2.default)({}, payload, {\n        type: type\n      });\n      var subscribers = getChildSubscribers(type);\n      subscribers && subscribers.forEach(function (subs) {\n        subs(payloadWithType);\n      });\n    };\n\n    var lastEmittedEvent = 'didBlur';\n\n    var cleanup = function cleanup() {\n      upstreamSubscribers.forEach(function (subs) {\n        return subs && subs.remove();\n      });\n    };\n\n    var upstreamEvents = ['willFocus', 'didFocus', 'willBlur', 'didBlur', 'action'];\n    var upstreamSubscribers = upstreamEvents.map(function (eventName) {\n      return addListener(eventName, function (payload) {\n        var state = payload.state,\n            lastState = payload.lastState,\n            action = payload.action;\n        var lastRoutes = lastState && lastState.routes;\n        var routes = state && state.routes;\n        var lastFocusKey = lastState && lastState.routes && lastState.routes[lastState.index].key;\n        var focusKey = routes && routes[state.index].key;\n        var isChildFocused = focusKey === key;\n        var lastRoute = lastRoutes && lastRoutes.find(function (route) {\n          return route.key === key;\n        });\n        var newRoute = routes && routes.find(function (route) {\n          return route.key === key;\n        });\n        var childPayload = {\n          context: key + \":\" + action.type + \"_\" + (payload.context || 'Root'),\n          state: newRoute,\n          lastState: lastRoute,\n          action: action,\n          type: eventName\n        };\n        var isTransitioning = !!state && state.isTransitioning;\n        var previouslyLastEmittedEvent = lastEmittedEvent;\n\n        if (lastEmittedEvent === 'didBlur') {\n          if (eventName === 'willFocus' && isChildFocused) {\n            emit(lastEmittedEvent = 'willFocus', childPayload);\n          } else if (eventName === 'action' && isChildFocused) {\n            emit(lastEmittedEvent = 'willFocus', childPayload);\n          }\n        }\n\n        if (lastEmittedEvent === 'willFocus') {\n          if (eventName === 'didFocus' && isChildFocused && !isTransitioning) {\n            emit(lastEmittedEvent = 'didFocus', childPayload);\n          } else if (eventName === 'action' && isChildFocused && !isTransitioning) {\n            emit(lastEmittedEvent = 'didFocus', childPayload);\n          }\n        }\n\n        if (lastEmittedEvent === 'didFocus') {\n          if (!isChildFocused) {\n            emit(lastEmittedEvent = 'willBlur', childPayload);\n          } else if (eventName === 'willBlur') {\n            emit(lastEmittedEvent = 'willBlur', childPayload);\n          } else if (eventName === 'action' && previouslyLastEmittedEvent === 'didFocus') {\n            emit('action', childPayload);\n          }\n        }\n\n        if (lastEmittedEvent === 'willBlur') {\n          if (eventName === 'action' && !isChildFocused && !isTransitioning) {\n            emit(lastEmittedEvent = 'didBlur', childPayload);\n          } else if (eventName === 'didBlur') {\n            emit(lastEmittedEvent = 'didBlur', childPayload);\n          }\n        }\n      });\n    });\n    return function (eventName, eventHandler) {\n      var subscribers = getChildSubscribers(eventName);\n\n      if (!subscribers) {\n        throw new Error(\"Invalid event name \\\"\" + eventName + \"\\\"\");\n      }\n\n      subscribers.add(eventHandler);\n\n      var remove = function remove() {\n        subscribers.delete(eventHandler);\n      };\n\n      return {\n        remove: remove\n      };\n    };\n  }\n});","map":[[11,0,8,15],[11,11,8,24,"getChildEventSubscriber"],[11,34,8,15],[11,35,8,48,"addListener"],[11,46,8,15],[11,48,8,61,"key"],[11,51,8,15],[11,53,8,66],[12,0,9,2],[12,8,9,8,"actionSubscribers"],[12,25,9,25],[12,28,9,28],[12,32,9,32,"Set"],[12,35,9,28],[12,37,9,2],[13,0,10,2],[13,8,10,8,"willFocusSubscribers"],[13,28,10,28],[13,31,10,31],[13,35,10,35,"Set"],[13,38,10,31],[13,40,10,2],[14,0,11,2],[14,8,11,8,"didFocusSubscribers"],[14,27,11,27],[14,30,11,30],[14,34,11,34,"Set"],[14,37,11,30],[14,39,11,2],[15,0,12,2],[15,8,12,8,"willBlurSubscribers"],[15,27,12,27],[15,30,12,30],[15,34,12,34,"Set"],[15,37,12,30],[15,39,12,2],[16,0,13,2],[16,8,13,8,"didBlurSubscribers"],[16,26,13,26],[16,29,13,29],[16,33,13,33,"Set"],[16,36,13,29],[16,38,13,2],[18,0,15,2],[18,8,15,8,"getChildSubscribers"],[18,27,15,27],[18,30,15,30],[18,39,15,8,"getChildSubscribers"],[18,58,15,30],[18,59,15,30,"evtName"],[18,66,15,37],[18,68,15,41],[19,0,16,4],[19,14,16,12,"evtName"],[19,21,16,4],[20,0,17,6],[20,13,17,11],[20,21,17,6],[21,0,18,8],[21,17,18,15,"actionSubscribers"],[21,34,18,8],[23,0,19,6],[23,13,19,11],[23,24,19,6],[24,0,20,8],[24,17,20,15,"willFocusSubscribers"],[24,37,20,8],[26,0,21,6],[26,13,21,11],[26,23,21,6],[27,0,22,8],[27,17,22,15,"didFocusSubscribers"],[27,36,22,8],[29,0,23,6],[29,13,23,11],[29,23,23,6],[30,0,24,8],[30,17,24,15,"willBlurSubscribers"],[30,36,24,8],[32,0,25,6],[32,13,25,11],[32,22,25,6],[33,0,26,8],[33,17,26,15,"didBlurSubscribers"],[33,35,26,8],[35,0,27,6],[36,0,28,8],[36,17,28,15],[36,21,28,8],[37,0,16,4],[38,0,30,3],[38,5,15,2],[40,0,32,2],[40,8,32,8,"emit"],[40,12,32,12],[40,15,32,15],[40,24,32,8,"emit"],[40,28,32,15],[40,29,32,16,"type"],[40,33,32,15],[40,35,32,22,"payload"],[40,42,32,15],[40,44,32,34],[41,0,33,4],[41,10,33,10,"payloadWithType"],[41,25,33,25],[41,60,33,33,"payload"],[41,67,33,25],[42,0,33,42,"type"],[42,8,33,42,"type"],[42,12,33,46],[42,14,33,42,"type"],[43,0,33,25],[43,8,33,4],[44,0,34,4],[44,10,34,10,"subscribers"],[44,21,34,21],[44,24,34,24,"getChildSubscribers"],[44,43,34,43],[44,44,34,44,"type"],[44,48,34,43],[44,49,34,4],[45,0,35,4,"subscribers"],[45,6,35,4,"subscribers"],[45,17,35,15],[45,21,36,6,"subscribers"],[45,32,36,17],[45,33,36,18,"forEach"],[45,40,36,6],[45,41,36,26],[45,51,36,26,"subs"],[45,55,36,30],[45,57,36,34],[46,0,37,8,"subs"],[46,8,37,8,"subs"],[46,12,37,12],[46,13,37,13,"payloadWithType"],[46,28,37,12],[46,29,37,8],[47,0,38,7],[47,7,36,6],[47,8,35,4],[48,0,39,3],[48,5,32,2],[50,0,45,2],[50,8,45,6,"lastEmittedEvent"],[50,24,45,22],[50,27,45,25],[50,36,45,2],[52,0,47,2],[52,8,47,8,"cleanup"],[52,15,47,15],[52,18,47,18],[52,27,47,8,"cleanup"],[52,34,47,18],[52,37,47,24],[53,0,48,4,"upstreamSubscribers"],[53,6,48,4,"upstreamSubscribers"],[53,25,48,23],[53,26,48,24,"forEach"],[53,33,48,4],[53,34,48,32],[53,44,48,32,"subs"],[53,48,48,36],[54,0,48,36],[54,15,48,40,"subs"],[54,19,48,44],[54,23,48,48,"subs"],[54,27,48,52],[54,28,48,53,"remove"],[54,34,48,48],[54,36,48,36],[55,0,48,36],[55,7,48,4],[56,0,49,3],[56,5,47,2],[58,0,51,2],[58,8,51,8,"upstreamEvents"],[58,22,51,22],[58,25,51,25],[58,26,52,4],[58,37,51,25],[58,39,53,4],[58,49,51,25],[58,51,54,4],[58,61,51,25],[58,63,55,4],[58,72,51,25],[58,74,56,4],[58,82,51,25],[58,83,51,2],[59,0,59,2],[59,8,59,8,"upstreamSubscribers"],[59,27,59,27],[59,30,59,30,"upstreamEvents"],[59,44,59,44],[59,45,59,45,"map"],[59,48,59,30],[59,49,59,49],[59,59,59,49,"eventName"],[59,68,59,58],[60,0,59,58],[60,13,60,4,"addListener"],[60,24,60,15],[60,25,60,16,"eventName"],[60,34,60,15],[60,36,60,27],[60,46,60,27,"payload"],[60,53,60,34],[60,55,60,38],[61,0,60,38],[61,12,61,14,"state"],[61,17,60,38],[61,20,61,43,"payload"],[61,27,60,38],[61,28,61,14,"state"],[61,33,60,38],[62,0,60,38],[62,12,61,21,"lastState"],[62,21,60,38],[62,24,61,43,"payload"],[62,31,60,38],[62,32,61,21,"lastState"],[62,41,60,38],[63,0,60,38],[63,12,61,32,"action"],[63,18,60,38],[63,21,61,43,"payload"],[63,28,60,38],[63,29,61,32,"action"],[63,35,60,38],[64,0,62,6],[64,12,62,12,"lastRoutes"],[64,22,62,22],[64,25,62,25,"lastState"],[64,34,62,34],[64,38,62,38,"lastState"],[64,47,62,47],[64,48,62,48,"routes"],[64,54,62,6],[65,0,63,6],[65,12,63,12,"routes"],[65,18,63,18],[65,21,63,21,"state"],[65,26,63,26],[65,30,63,30,"state"],[65,35,63,35],[65,36,63,36,"routes"],[65,42,63,6],[66,0,65,6],[66,12,65,12,"lastFocusKey"],[66,24,65,24],[66,27,66,8,"lastState"],[66,36,66,17],[66,40,66,21,"lastState"],[66,49,66,30],[66,50,66,31,"routes"],[66,56,66,8],[66,60,66,41,"lastState"],[66,69,66,50],[66,70,66,51,"routes"],[66,76,66,41],[66,77,66,58,"lastState"],[66,86,66,67],[66,87,66,68,"index"],[66,92,66,41],[66,94,66,75,"key"],[66,97,65,6],[67,0,67,6],[67,12,67,12,"focusKey"],[67,20,67,20],[67,23,67,23,"routes"],[67,29,67,29],[67,33,67,33,"routes"],[67,39,67,39],[67,40,67,40,"state"],[67,45,67,45],[67,46,67,46,"index"],[67,51,67,39],[67,52,67,33],[67,53,67,53,"key"],[67,56,67,6],[68,0,69,6],[68,12,69,12,"isChildFocused"],[68,26,69,26],[68,29,69,29,"focusKey"],[68,37,69,37],[68,42,69,42,"key"],[68,45,69,6],[69,0,70,6],[69,12,70,12,"lastRoute"],[69,21,70,21],[69,24,71,8,"lastRoutes"],[69,34,71,18],[69,38,71,22,"lastRoutes"],[69,48,71,32],[69,49,71,33,"find"],[69,53,71,22],[69,54,71,38],[69,64,71,38,"route"],[69,69,71,43],[70,0,71,43],[70,17,71,47,"route"],[70,22,71,52],[70,23,71,53,"key"],[70,26,71,47],[70,31,71,61,"key"],[70,34,71,43],[71,0,71,43],[71,9,71,22],[71,10,70,6],[72,0,72,6],[72,12,72,12,"newRoute"],[72,20,72,20],[72,23,72,23,"routes"],[72,29,72,29],[72,33,72,33,"routes"],[72,39,72,39],[72,40,72,40,"find"],[72,44,72,33],[72,45,72,45],[72,55,72,45,"route"],[72,60,72,50],[73,0,72,50],[73,17,72,54,"route"],[73,22,72,59],[73,23,72,60,"key"],[73,26,72,54],[73,31,72,68,"key"],[73,34,72,50],[74,0,72,50],[74,9,72,33],[74,10,72,6],[75,0,73,6],[75,12,73,12,"childPayload"],[75,24,73,24],[75,27,73,27],[76,0,74,8,"context"],[76,10,74,8,"context"],[76,17,74,15],[76,19,74,20,"key"],[76,22,74,15],[76,31,74,27,"action"],[76,37,74,33],[76,38,74,34,"type"],[76,42,74,15],[76,52,74,42,"payload"],[76,59,74,49],[76,60,74,50,"context"],[76,67,74,42],[76,71,74,61],[76,77,74,15],[76,78,73,27],[77,0,75,8,"state"],[77,10,75,8,"state"],[77,15,75,13],[77,17,75,15,"newRoute"],[77,25,73,27],[78,0,76,8,"lastState"],[78,10,76,8,"lastState"],[78,19,76,17],[78,21,76,19,"lastRoute"],[78,30,73,27],[79,0,77,8,"action"],[79,10,77,8,"action"],[79,16,77,14],[79,18,77,8,"action"],[79,24,73,27],[80,0,78,8,"type"],[80,10,78,8,"type"],[80,14,78,12],[80,16,78,14,"eventName"],[81,0,73,27],[81,9,73,6],[82,0,80,6],[82,12,80,12,"isTransitioning"],[82,27,80,27],[82,30,80,30],[82,31,80,31],[82,32,80,32,"state"],[82,37,80,30],[82,41,80,41,"state"],[82,46,80,46],[82,47,80,47,"isTransitioning"],[82,62,80,6],[83,0,82,6],[83,12,82,12,"previouslyLastEmittedEvent"],[83,38,82,38],[83,41,82,41,"lastEmittedEvent"],[83,57,82,6],[85,0,84,6],[85,12,84,10,"lastEmittedEvent"],[85,28,84,26],[85,33,84,31],[85,42,84,6],[85,44,84,42],[86,0,86,8],[86,14,86,12,"eventName"],[86,23,86,21],[86,28,86,26],[86,39,86,12],[86,43,86,41,"isChildFocused"],[86,57,86,8],[86,59,86,57],[87,0,87,10,"emit"],[87,12,87,10,"emit"],[87,16,87,14],[87,17,87,16,"lastEmittedEvent"],[87,33,87,32],[87,36,87,35],[87,47,87,14],[87,49,87,49,"childPayload"],[87,61,87,14],[87,62,87,10],[88,0,88,9],[88,11,86,8],[88,17,88,15],[88,21,88,19,"eventName"],[88,30,88,28],[88,35,88,33],[88,43,88,19],[88,47,88,45,"isChildFocused"],[88,61,88,15],[88,63,88,61],[89,0,89,10,"emit"],[89,12,89,10,"emit"],[89,16,89,14],[89,17,89,16,"lastEmittedEvent"],[89,33,89,32],[89,36,89,35],[89,47,89,14],[89,49,89,49,"childPayload"],[89,61,89,14],[89,62,89,10],[90,0,90,9],[91,0,91,7],[93,0,92,6],[93,12,92,10,"lastEmittedEvent"],[93,28,92,26],[93,33,92,31],[93,44,92,6],[93,46,92,44],[94,0,95,8],[94,14,95,12,"eventName"],[94,23,95,21],[94,28,95,26],[94,38,95,12],[94,42,95,40,"isChildFocused"],[94,56,95,12],[94,60,95,58],[94,61,95,59,"isTransitioning"],[94,76,95,8],[94,78,95,76],[95,0,96,10,"emit"],[95,12,96,10,"emit"],[95,16,96,14],[95,17,96,16,"lastEmittedEvent"],[95,33,96,32],[95,36,96,35],[95,46,96,14],[95,48,96,48,"childPayload"],[95,60,96,14],[95,61,96,10],[96,0,97,9],[96,11,95,8],[96,17,97,15],[96,21,98,10,"eventName"],[96,30,98,19],[96,35,98,24],[96,43,98,10],[96,47,99,10,"isChildFocused"],[96,61,98,10],[96,65,100,10],[96,66,100,11,"isTransitioning"],[96,81,97,15],[96,83,101,10],[97,0,102,10,"emit"],[97,12,102,10,"emit"],[97,16,102,14],[97,17,102,16,"lastEmittedEvent"],[97,33,102,32],[97,36,102,35],[97,46,102,14],[97,48,102,48,"childPayload"],[97,60,102,14],[97,61,102,10],[98,0,103,9],[99,0,104,7],[101,0,106,6],[101,12,106,10,"lastEmittedEvent"],[101,28,106,26],[101,33,106,31],[101,43,106,6],[101,45,106,43],[102,0,108,8],[102,14,108,12],[102,15,108,13,"isChildFocused"],[102,29,108,8],[102,31,108,29],[103,0,110,10,"emit"],[103,12,110,10,"emit"],[103,16,110,14],[103,17,110,16,"lastEmittedEvent"],[103,33,110,32],[103,36,110,35],[103,46,110,14],[103,48,110,48,"childPayload"],[103,60,110,14],[103,61,110,10],[104,0,111,9],[104,11,108,8],[104,17,111,15],[104,21,111,19,"eventName"],[104,30,111,28],[104,35,111,33],[104,45,111,15],[104,47,111,45],[105,0,113,10,"emit"],[105,12,113,10,"emit"],[105,16,113,14],[105,17,113,16,"lastEmittedEvent"],[105,33,113,32],[105,36,113,35],[105,46,113,14],[105,48,113,48,"childPayload"],[105,60,113,14],[105,61,113,10],[106,0,114,9],[106,11,111,15],[106,17,114,15],[106,21,115,10,"eventName"],[106,30,115,19],[106,35,115,24],[106,43,115,10],[106,47,116,10,"previouslyLastEmittedEvent"],[106,73,116,36],[106,78,116,41],[106,88,114,15],[106,90,117,10],[107,0,119,10,"emit"],[107,12,119,10,"emit"],[107,16,119,14],[107,17,119,15],[107,25,119,14],[107,27,119,25,"childPayload"],[107,39,119,14],[107,40,119,10],[108,0,120,9],[109,0,121,7],[111,0,123,6],[111,12,123,10,"lastEmittedEvent"],[111,28,123,26],[111,33,123,31],[111,43,123,6],[111,45,123,43],[112,0,125,8],[112,14,125,12,"eventName"],[112,23,125,21],[112,28,125,26],[112,36,125,12],[112,40,125,38],[112,41,125,39,"isChildFocused"],[112,55,125,12],[112,59,125,57],[112,60,125,58,"isTransitioning"],[112,75,125,8],[112,77,125,75],[113,0,128,10,"emit"],[113,12,128,10,"emit"],[113,16,128,14],[113,17,128,16,"lastEmittedEvent"],[113,33,128,32],[113,36,128,35],[113,45,128,14],[113,47,128,47,"childPayload"],[113,59,128,14],[113,60,128,10],[114,0,129,9],[114,11,125,8],[114,17,129,15],[114,21,129,19,"eventName"],[114,30,129,28],[114,35,129,33],[114,44,129,15],[114,46,129,44],[115,0,131,10,"emit"],[115,12,131,10,"emit"],[115,16,131,14],[115,17,131,16,"lastEmittedEvent"],[115,33,131,32],[115,36,131,35],[115,45,131,14],[115,47,131,47,"childPayload"],[115,59,131,14],[115,60,131,10],[116,0,132,9],[117,0,133,7],[118,0,134,5],[118,7,60,15],[118,8,59,58],[119,0,59,58],[119,5,59,30],[119,6,59,2],[120,0,137,2],[120,11,137,9],[120,21,137,10,"eventName"],[120,30,137,9],[120,32,137,21,"eventHandler"],[120,44,137,9],[120,46,137,38],[121,0,138,4],[121,10,138,10,"subscribers"],[121,21,138,21],[121,24,138,24,"getChildSubscribers"],[121,43,138,43],[121,44,138,44,"eventName"],[121,53,138,43],[121,54,138,4],[123,0,139,4],[123,10,139,8],[123,11,139,9,"subscribers"],[123,22,139,4],[123,24,139,22],[124,0,140,6],[124,14,140,12],[124,18,140,16,"Error"],[124,23,140,12],[124,50,140,45,"eventName"],[124,59,140,12],[124,67,140,6],[125,0,141,5],[127,0,142,4,"subscribers"],[127,6,142,4,"subscribers"],[127,17,142,15],[127,18,142,16,"add"],[127,21,142,4],[127,22,142,20,"eventHandler"],[127,34,142,4],[129,0,143,4],[129,10,143,10,"remove"],[129,16,143,16],[129,19,143,19],[129,28,143,10,"remove"],[129,34,143,19],[129,37,143,25],[130,0,144,6,"subscribers"],[130,8,144,6,"subscribers"],[130,19,144,17],[130,20,144,18,"delete"],[130,26,144,6],[130,27,144,25,"eventHandler"],[130,39,144,6],[131,0,145,5],[131,7,143,4],[133,0,146,4],[133,13,146,11],[134,0,146,13,"remove"],[134,8,146,13,"remove"],[134,14,146,19],[134,16,146,13,"remove"],[135,0,146,11],[135,7,146,4],[136,0,147,3],[136,5,137,2],[137,0,148,1]]},"type":"js/module"}]}